# Tutorial-3-Embedded-Systems-and-IoT


Objectives
1.	ควบคุมเครื่องใช้ไฟฟ้าผ่าน dashboard ด้วย relay ได้

Hardware
1.	Touch Sensor          1	        
2.	LED		                x
4.  Solid StateRelay 2CH  1
5.  Resistor 330 ohms     1
4.	Breadboard            1
5.	Computer	            1
6.	microUSB	            1
7.	microcontroller       1   

Software
1. Arduino IDE
--------------------
Instruction

T สร้างระบบควบคุมหลอดไฟและพัดลม
1. ที่ตัว potentiometer ต่อขา GND และ VCC เข้าขา GND และ GPIO 04 ของ ESP32 ตามลำดับ
2. ที่ตัว potentiometer ต่อขา SIG ไปยังขาหนึ่งของตัวต้านทาน
3. ต่อวงจร LED 1 ดวงจากตัวต้านทานและต่อขา GND ให้เรียบร้อย
4. ต่อสายสัญญาณจาก GPIO 36 ไปเชื่อมระหว่างตัวต้านทานและขา SIG
5. เขียนโปรแกรมจากไฟล์ DownLight.ino
6. ทดสอบโปรแกรมโดยปรับระดับที่ตัวหมุนของ potentiometer

Potentiometer

เป็นอุปกรณ์อิเล็กทรอนิกส์ประเภทหนึ่ง มีหลายลักษณะการทำงานและการใช้งาน โดยหนึ่งในนั้นจะเป็นแบบที่หมุนได้ทำหน้าที่เป็นตัวต้านทานที่สามารถปรับค่าได้ส่งผลให้ได้ค่าความต้านทานที่ต้องการ

![what-is-potentiometer_3](https://user-images.githubusercontent.com/125423996/219269830-60df34ee-ca69-4e41-8c50-99788d37e086.jpg)
[ภาพจาก riverglennapts.com]
![asdasdsad](https://user-images.githubusercontent.com/125423996/219522043-142f2464-51ba-4b6b-92a0-c2ffe9662d04.JPG)


--------------------

T 5.2 การใช้งาน Relay ควบคุมเครื่องใช้ไฟฟ้าภายในบ้าน
1. ต่อเซ็นเซอร์อัลตราโซนิกให้รับค่าระยะทางได้ โดยไม่ให้ใช้ GPIO 04 กับเซ็นเซอร์
1. ต่อขา GPIO 04 ไปยังขา IN1 ของรีเลย์
2. ต่อสายไฟและสายดินสำหรับรีเลย์
3. ตัดสายไฟ 1 สายของอุปกรณ์ไฟฟ้า
4. ทำการต่อสายไฟที่ตัดข้างหนึ่งเข้ากับขา Common ของรีเลย์
5. ทำการต่อสายไฟที่ตัดอีกข้างหนึ่งเข้ากับขา NO ของรีเลย์
6. เขียนโปรแกรมโดยตั้งเงื่อนไขหากระยะน้อยกว่า 15cm. ให้ไฟติด และหากระยะเป็นตั้งแต่ 15cm. ขึ้นไปให้ไฟดับ


![relay-esp32-wiring](https://user-images.githubusercontent.com/125423996/219270742-3a012498-10bc-4e7e-9985-c47089516265.jpg)
[ภาพจาก randomnerdtutorials.com]


Relay

เป็นอุปกรณ์อิเล็กทรอนิกส์ที่ทำหน้าที่เป็นเหมือนสวิชต์เพื่อควบคุมระบบอีกฝั่งหนึ่ง สามารถนำมาใช้เป็นตัวตัดกระแสไฟฟ้าไปเลี้ยงอุปกรณ์ได้ เช่น ระบบเปิด/ปิดเครื่องใช้ไฟฟ้า โดยรีเลย์ที่นำมาใช้ในวิชานี้จะมีหลักการทำงานคือ รีเลย์จะมีการควบคุมการทำงานโดยแบ่งออกเป็น 2 ฝั่ง คือฝั่งควบคุมที่รับค่า input จากไมโครคอนโทรลเลอร์ และฝั่ง output ที่จะทำหน้าที่เป็นสวิชต์ควบคุมอุปกรณ์อื่นๆ

ฝั่ง input จะมี 3 ขาคือ VCC และ GND ทำหน้าที่เป็นไฟเลี้ยงและ ground ให้รีเลย์ทำงาน และขา IN เพื่อรับค่ามาจากไมโครคอนโทรลเลอร์
ฝั่ง output จะมี 3 ขา  คือ NO, NC, และ Common โดยขา NO ย่อมาจาก Normal Open และ NC ย่อมาจาก Normal close โดยที่ขา NO หมายถึงสถานะที่ relay ไม่ได้รับ input "1" จากไมโครคอนโทรลเลอร์ ขานี้จะมีสถานะ "เปิด" หมายถึงกระแสไฟไม่วิ่งผ่าน ส่วนขา NC หาก relay ไม่ได้รับ input "1" จะมีสถานะ "ปิด" กระแสไฟจะวิ่งผ่าน

หาก relay ได้รับค่า "1 หรือ HIGH" จากไมโครคอนโทรลเลอร์ จะส่งผลให้ขา NO มีสถานะเป็น ปิด และ NC มีสถานะเป็นเปิด ส่งผลให้กระแสไฟที่ก่อนหน้านี้ไม่วิ่งผ่าน NO จะวิ่งผ่านหลังจากได้รับ "HIGH" จากไมโครคอนโทรลเลอร์

สถานะ "เปิด" หรือ "ปิด" มาจากการที่โลหะสองฝั่งสัมผัสหรือไม่สัมผัสกัน โดย "เปิด" หมายถึงไม่สัมผัสทำให้กระแสไฟไม่ไหลผ่าน ส่วน "ปิด" คือสัมผัสกันส่งผลให้กระแสไฟไหลผ่านได้

![sdfsdfsdfdf](https://user-images.githubusercontent.com/125423996/219522596-739e4e98-6796-4952-8fa4-ce29fc6ba3c9.JPG)
[ภาพจาก etechnog.com]


